# Binary Exploitation

# Pwn

## picoCTF Hijacking

We are given a  python script that we can write to. We can run this script as root. We have to figure out a way of gaining root code execution via this script. We overwrite the script to simply spawn a root shell when it is called.

```
import os

os.system("/bin/sh")
```

Spawns a root interactive shell. The flag is in a hidden file in the /root directory.

## picoCTF  two-sum

We netcat into an instance, and must give two numbers such that 

```n1 > n1 + n2 OR n2 > n1 + n2```

Think it about it logically: two positive numbers will always make this false, since two positive numbers summed will be greater than either individual number. We cannot have negative numbers. 

What if we give two numbers, and cause the program to error?

```1000000000 99999999999999999``` 

gets us the flag.

## picoCTF  VNE

We are given a binary that will run ls as root, on whatever the enviroment variable SECRET_DIR is set to. We can enumerate the contents of the root directory like this:

```
export SECRET_DIR="/root"

./bin
```

This isn't much, so we try command injection to see if we can get the binary to run other things as root

```
export SECRET_DIR="/root; cat /root/flag.txt"

./bin
```

Yields the flag.

